# 安全扫描

* 扫描开始

用户点击开始扫描时，判断该扫描是否已经开始。

如果未开始，则将该扫描拆分为多个任务，并且将任务插入到 task 表中。

* 扫描任务（Task）完成

某个扫描任务完成后，需要首先修改 task 表中的状态。

然后根据任务的结果，拆分出其中包含的漏洞信息，将其写入到 task_results 中。

同时需要提取出最严重的漏洞结果，判断其是否需要覆写该任务从属的扫描中，scan_security_level 字段的值。

最后需要将本次扫描到的漏洞信息，写入到 asset_vulns 表中。

* 扫描完成

更新 asset 表中的漏洞统计。

更新当天的 vulns_statistics_daily 表。

# 数据统计

* 漏洞列表

漏洞列表，需要联查 asset 与 asset_vulns 表，根据 last_scan_id，获取最后一次查询中存在的漏洞列表。
